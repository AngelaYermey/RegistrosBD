
-------------------------------------------------------------------------------------------
-- Base de datos de pruebas
CREATE DATABASE IF NOT EXISTS DB_Universidad;
USE DB_Universidad;

-- Tabla de centros regionales
CREATE TABLE centros_regionales (
    id_centroRegional INT AUTO_INCREMENT PRIMARY KEY,
    nombre_centro VARCHAR(100) NOT NULL UNIQUE,
     cedula_admin VARCHAR(30),
     FOREIGN KEY (cedula_admin) REFERENCES administradores(cedula_admin)
);

-- Tabla de administradores
CREATE TABLE administradores (
    cedula_admin VARCHAR(30) PRIMARY KEY,
    nombre VARCHAR(30) NOT NULL,
    apellido VARCHAR(30) NOT NULL,
    contraseña VARCHAR(100) NOT NULL
);

-- Tabla de estudiantes
CREATE TABLE estudiantes (
    cedula_estudiante VARCHAR(30) PRIMARY KEY,
    nombre VARCHAR(30) NOT NULL,
    apellido VARCHAR(30) NOT NULL,
    email VARCHAR(100) NOT NULL,
    facultad VARCHAR(50) NOT NULL,
    carrera VARCHAR(100) NOT NULL,
    id_centroRegional INT NOT NULL,
    año INT NOT NULL,
    contraseña VARCHAR(100) NOT NULL,
    cedula_admin VARCHAR(30),
    FOREIGN KEY (id_centroRegional) REFERENCES centros_regionales(id_centroRegional),
    FOREIGN KEY (cedula_admin) REFERENCES administradores(cedula_admin)
);

-- Tabla de profesores
CREATE TABLE profesores (
    cedula_prof VARCHAR(30) PRIMARY KEY,
    nombre VARCHAR(30) NOT NULL,
    apellido VARCHAR(30) NOT NULL,
    email VARCHAR(100) NOT NULL,
    contraseña VARCHAR(100) NOT NULL,
    cedula_admin VARCHAR(30),
    FOREIGN KEY (cedula_admin) REFERENCES administradores(cedula_admin)
);

-- Tabla de asignaturas
CREATE TABLE asignaturas (
    codigo_asignatura VARCHAR(50) PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL,
    id_centroRegional INT NOT NULL,
    FOREIGN KEY (id_centroRegional) REFERENCES centros_regionales(id_centroRegional)
);

-- Tabla de registros de clase
CREATE TABLE clases (
    id INT AUTO_INCREMENT PRIMARY KEY,
    codigo_asignatura VARCHAR(50) NOT NULL,
    cedula_prof VARCHAR(30) NOT NULL,
    tema_clase VARCHAR(100) NOT NULL,
    texto_clase TEXT NOT NULL,
    fecha DATE NOT NULL,
    FOREIGN KEY (codigo_asignatura) REFERENCES asignaturas(codigo_asignatura),
    FOREIGN KEY (cedula_prof) REFERENCES profesores(cedula_prof)

);



llenando tablas

-- Datos para la tabla de centros_regionales
INSERT INTO centros_regionales (nombre_centro) VALUES 
('Azuero'),
('Coclé'),
('Veraguas'),
('Bocas del Toro'),
('Chiriquí'),
('Colón'),
('Panamá Oeste');


-- Datos para la tabla de administradores
INSERT INTO administradores (cedula_admin, nombre, apellido, contraseña) VALUES 
('8-123-456', 'Carlos', 'Rodríguez', 'contraseña123'),
('3-987-654', 'María', 'López', 'contraseña456');

-- Datos para la tabla de estudiantes
INSERT INTO estudiantes (cedula_estudiante, nombre, apellido, email, facultad, carrera, id_centroRegional, año, contraseña, cedula_admin) VALUES 
('8-765-432', 'Ana', 'González', 'ana.gonzalez@example.com', 'Facultad de Ingeniería', 'Ingeniería Civil', 1, 2023, 'estudiante123', '8-123-456'),
('9-876-543', 'Luis', 'Martínez', 'luis.martinez@example.com', 'Facultad de Ciencias', 'Biología', 2, 2022, 'estudiante456', '3-987-654'),
('7-654-321', 'Carmen', 'Pérez', 'carmen.perez@example.com', 'Facultad de Medicina', 'Medicina', 3, 2024, 'estudiante789', '8-123-456');

-- Datos para la tabla de profesores
INSERT INTO profesores (cedula_prof, nombre, apellido, email, contraseña, cedula_admin) VALUES 
('4-321-654', 'Roberto', 'Fernández', 'roberto.fernandez@example.com', 'profesor123', '8-123-456'),
('5-432-765', 'Elena', 'Jiménez', 'elena.jimenez@example.com', 'profesor456', '3-987-654');

-- Datos para la tabla de asignaturas
INSERT INTO asignaturas (codigo_asignatura, nombre, id_centroRegional) VALUES 
('MATH101', 'Matemáticas Básicas', 1),
('BIO102', 'Biología General', 2),
('MED103', 'Introducción a la Medicina', 3);

-- Datos para la tabla de clases
INSERT INTO clases (codigo_asignatura, cedula_prof, nombre_clase, texto_clase, fecha, hora) VALUES 
('MATH101', '4-321-654', 'Clase 1', 'Introducción a las matemáticas básicas', '2024-05-21', '08:00:00'),
('BIO102', '5-432-765', 'Clase 1', 'Introducción a la biología general', '2024-05-22', '09:00:00');





SELECT 
    asignaturas.codigo_asignatura, 
    asignaturas.nombre AS nombre_asignatura,
    clases.texto_clase, 
    profesores.nombre AS nombre_profesor,
    clases.fecha
FROM 
    clases 
INNER JOIN 
    asignaturas ON clases.codigo_asignatura = asignaturas.codigo_asignatura 
INNER JOIN 
    profesores ON clases.cedula_prof = profesores.cedula_prof 
INNER JOIN 
    estudiantes ON asignaturas.id_centroRegional = estudiantes.id_centroRegional 
WHERE 
    estudiantes.cedula_estudiante = '7-654-321' 
    AND estudiantes.id_centroRegional = (
        SELECT id_centroRegional 
        FROM estudiantes 
        WHERE cedula_estudiante = '7-654-321'
    )
ORDER BY 
    clases.fecha DESC;
